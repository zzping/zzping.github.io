(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{412:function(s,e,a){"use strict";a.r(e);var r=a(45),t=Object(r.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"docker-compose"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose"}},[s._v("#")]),s._v(" Docker Compose")]),s._v(" "),a("h2",{attrs:{id:"compose-简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compose-简介"}},[s._v("#")]),s._v(" compose 简介")]),s._v(" "),a("p",[a("code",[s._v("compose")]),s._v(" 是 Docker 官方的开源项目，它是用于"),a("code",[s._v("定义和运行多容器")]),s._v(" Docker 应用程序的工具。可以对多个容器进行编排（让多个容器有一定顺序的启动）。")]),s._v(" "),a("p",[s._v("通过 "),a("code",[s._v("compose")]),s._v(" ，你可以使用 YAML 文件来配置应用程序的服务，然后通过一个命令即可从配置中创建并启动所有服务。")]),s._v(" "),a("p",[s._v("Github 地址： https://github.com/docker/compose")]),s._v(" "),a("p",[s._v("（1）compose 中两种重要的概念")]),s._v(" "),a("ul",[a("li",[s._v("项目（"),a("code",[s._v("project")]),s._v("）： 由一组关联的应用容器组成的一个完整业务单元，在 "),a("code",[s._v("docker-compose.yml")]),s._v(" 中定义")]),s._v(" "),a("li",[s._v("服务（"),a("code",[s._v("service")]),s._v("）： 一个应用的容器，实际上可以包括若干运行相同镜像的容器实例。")])]),s._v(" "),a("h2",{attrs:{id:"compose-安装和卸载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compose-安装和卸载"}},[s._v("#")]),s._v(" compose 安装和卸载")]),s._v(" "),a("p",[s._v("官方文档： "),a("a",{attrs:{href:"https://docs.docker.com/compose/install/",target:"_blank",rel:"noopener noreferrer"}},[s._v("compose 的安装"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("安装前的准备工作：")]),s._v(" "),a("ul",[a("li",[s._v("docker compose  依靠 docker engine 才能工作。确保先安装了 docker engine")]),s._v(" "),a("li",[s._v("桌面系统（mac、window）上，docker compose 是包含在了 docker engine 之中的，无序额外安装")]),s._v(" "),a("li",[s._v("linux 系统上，安装了 docker engine 后需要额外安装 docker compose")])]),s._v(" "),a("hr"),s._v(" "),a("p",[a("strong",[s._v("Linux 上安装 docker compose")]),s._v("：")]),s._v(" "),a("p",[s._v("（1）通过 curl 下载 docker compose")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -L "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://github.com/docker/compose/releases/download/1.28.2/docker-compose-'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -s"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("-"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -m"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v(" -o /usr/local/bin/docker-compose\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 放在 /usr/local/bin 这个目录就不用手动配置环境变量。随处都可以使用 docker-compose 命令")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("（2）修改 docker compose 文件的权限")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /usr/local/bin/docker-compose\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("（3）查看 docker compose 是否安装成功")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker-compose --version\n\n# docker-compose version 1.28.2, build 67630359\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("hr"),s._v(" "),a("p",[a("strong",[s._v("Linux 上卸载 docker compose：")])]),s._v(" "),a("p",[s._v("（1）如果是使用 "),a("code",[s._v("curl")]),s._v(" 命令安装的，则卸载方法如下：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" /usr/local/bin/docker-compose\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("（2）如果是使用 "),a("code",[s._v("pip")]),s._v(" 命令安装的，则卸载方法如下：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("pip uninstall docker-compose\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[s._v("docker componse 部署常用的软件")]),s._v(" "),a("p",[s._v("docker compose 的最佳实践")])]),s._v(" "),a("h2",{attrs:{id:"compose-的第一个程序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compose-的第一个程序"}},[s._v("#")]),s._v(" compose 的第一个程序")]),s._v(" "),a("p",[a("strong",[s._v("官方文档")]),s._v("： "),a("a",{attrs:{href:"https://docs.docker.com/compose/gettingstarted/",target:"_blank",rel:"noopener noreferrer"}},[s._v("快速开始"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("（1）新建一个空的目录 "),a("code",[s._v("hello")]),s._v("，并进入该目录下")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" hello\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /hello\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("（2）新建一个 "),a("code",[s._v("docker-compose.yml")]),s._v(" 文件")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" docker-compose.yml\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加如下内容")]),s._v("\nversion: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.8"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# compose 的版本")]),s._v("\nservices:\n  tomcat: "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务名,要保证唯一性")]),s._v("\n    image: tomcat:8.0.52 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 镜像")]),s._v("\n    container_name: tomcat01 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 容器名称")]),s._v("\n    ports: "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 端口, 可以映射多个端口")]),s._v("\n      - "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":8080\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("（3）使用 "),a("code",[s._v("docker-compose up")]),s._v(" 命令启动")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("docker-compose up -d\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("（4）访问容器测试是否启动成功")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看容器状态")]),s._v("\ndocker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curl 访问")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" http://192.168.145.31:8080/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"compose-的-yml-文件模板指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compose-的-yml-文件模板指令"}},[s._v("#")]),s._v(" compose 的 yml 文件模板指令")]),s._v(" "),a("p",[a("strong",[s._v("官方文档")]),s._v("： "),a("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-file-v3/",target:"_blank",rel:"noopener noreferrer"}},[s._v("compose 模板指令"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("code",[s._v("docker compose")]),s._v(" 的模板文件默认名称为 "),a("code",[s._v("docker-compose.yml")]),s._v("，格式为 YAML 格式。")]),s._v(" "),a("p",[s._v("注意： services 下的每一个服务都必须通过 "),a("code",[s._v("image")]),s._v(" 指令指定镜像或者 "),a("code",[s._v("build")]),s._v(" 指令（需要有 Dockerfile）来自动构建生成镜像。")]),s._v(" "),a("h3",{attrs:{id:"build"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build"}},[s._v("#")]),s._v(" build")]),s._v(" "),a("blockquote",[a("p",[s._v("container_name 对应 docker run 命令中的 --name 参数")]),s._v(" "),a("p",[s._v("ports 对应 docker run 命令中的 -p 参数")])]),s._v(" "),a("h2",{attrs:{id:"compose-的命令行命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compose-的命令行命令"}},[s._v("#")]),s._v(" compose 的命令行命令")]),s._v(" "),a("p",[a("strong",[s._v("官方文档")]),s._v("： "),a("a",{attrs:{href:"https://docs.docker.com/compose/reference/",target:"_blank",rel:"noopener noreferrer"}},[s._v("compose 命令行命令"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"compose-安装常用的软件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compose-安装常用的软件"}},[s._v("#")]),s._v(" compose 安装常用的软件")]),s._v(" "),a("h2",{attrs:{id:"compose-的最佳实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compose-的最佳实践"}},[s._v("#")]),s._v(" compose 的最佳实践")])])}),[],!1,null,null,null);e.default=t.exports}}]);