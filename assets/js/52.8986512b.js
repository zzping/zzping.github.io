(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{452:function(s,t,a){"use strict";a.r(t);var n=a(45),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"运行时数据区域之-程序计数器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行时数据区域之-程序计数器"}},[s._v("#")]),s._v(" 运行时数据区域之 - 程序计数器")]),s._v(" "),a("blockquote",[a("p",[s._v("《Java 虚拟机规范中》对程序计数器的描述：")]),s._v(" "),a("p",[s._v("https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-2.html#jvms-2.5")])]),s._v(" "),a("p",[s._v("程序计数器/PC 寄存器（"),a("code",[s._v("Program Counter Register")]),s._v("）是一块较小的内存空间，【这里的寄存器并非广义上的物理寄存器】每个线程都有一个独立的程序计数器。这个内存区域是唯一一个在《Java 虚拟机规范》中没有任何规定 OutOfMemoryError 情况的区域。")]),s._v(" "),a("p",[s._v("程序计数器的作用：")]),s._v(" "),a("blockquote",[a("p",[a("strong",[s._v("程序计数器用来存储指向下一条指令的地址（偏移地址）。执行引擎会从 pc 寄存器中读取下一条指令的地址，然后根据地址取出下一条指令，最后翻译成机器码执行。")])])]),s._v(" "),a("p",[a("code",[s._v("提问：为什么要使用 pc 寄存器记录当前线程的下一个指令执行地址呢？")])]),s._v(" "),a("blockquote",[a("p",[s._v("因为 JVM 是允许多线程并行·执行的，而且 JVM 的多线程是通过线程轮流切换、分配处理器执行时间的方式来实现的。在任何一个确定的时刻，一个处理器（对于多核处理 器来说就是一个核）都只会执行一个线程中的指令。所以为了线程切换后能恢复到正确的执行位置。每个线程需要有一个独立的程序计数器来存储指令地址。")])]),s._v(" "),a("p",[a("strong",[a("code",[s._v("关于运行时数据区域的每个区域有两个说明：GC 和 OOM")])])]),s._v(" "),a("blockquote",[a("p",[s._v("【GC、OOM】")]),s._v(" "),a("p",[s._v("程序计数器：                      \t\t\t\t【不会发生 GC、也没有 OOM】")]),s._v(" "),a("p",[s._v("Java 虚拟机栈、本地方法栈：       【不会发生 GC、会有 OOM】")]),s._v(" "),a("p",[s._v("堆、方法区：                                    【会发生 GC、会有 OOM】")])]),s._v(" "),a("p",[a("code",[s._v("举例说明")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/images/jvm/pc-register.png",alt:"程序计数器"}})]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PCRegisterTest")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" j "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" k "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" j"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" str "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"abc"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// javap -verbose PCRegisterTest.class 或者 javap -v PCRegisterTest.class ")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 如下图所示，pc 寄存器中存储的就是左边的指令地址。执行引擎会去 pc 寄存器中读取该值并找到相应指令翻译")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 成机器指令执行。这个过程中还会涉及到 本地变量表、操作数栈、等等进行数据存、取、操作等。")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);